{% load static %}
{% load date_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="{% static "/fontawesome/css/all.css" %}" >
	<link rel="stylesheet" href="{% static "/css/bootstrap.min.css" %}">
	<link rel="stylesheet" href="{% static "/css/style.css" %}"></link>
	<title>{% block title %}Tasks{% endblock %}</title>
	{% block head %}{% endblock %}
</head>
<body>
	<div class="nav>
		{% if user.is_authenticated %}
			<p>Welcome, {{ user.username }}. Thanks for logging in.</p>
		{% else %}
			<a href="/api-auth/login">Login</a>
		{% endif %}
	</div>
	<div class="container fluid">
		<div id="app" class="row fullheight">
			<div class="col-sm-2 bg-primary">
				a
			</div>
			<div class="col-sm-2 bg-secondary">
				b
			</div>
			<div class="col-sm-8 bg-info">
				c
			</div>
		</div>
	</div>
	<script src="{% static "/js/jquery-3.2.1.min.js" %}"></script>
	<script src="{% static "/js/bootstrap.min.js" %}"></script>
	<script src="{% static "/js/moment-with-locales.min.js" %}"></script>
	<script src="{% static "/js/vue.min.js" %}"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script>
		document.addEventListener("DOMContentLoaded", function(event) {
			app = new Vue({
				el: "#app",
				data: {
					queues: [],
					tasks: [],
					details: ""
				},
				created: function() {
					axios.get("/api/queues/")
					.then(function (response) {
						queues = response.data;
					})
					.catch(function (error) {
						console.log(error);
					});
				},
				methods: {
					loadDetails: function(hub) {
						document.location.href = "/hub/" + hub.identifier;
					},
					highlight: function(hub) {
						markersById[hub.identifier].setStyle({radius: 15});
					},
					highlightReset: function(hub) {
						markersById[hub.identifier].setStyle({radius: 10});
					},
					badgeClassByStatus: function(entity) {
						switch(entity.status) {
							case "ERROR":
								return "badge-danger";
							case "WARNING":
								return "badge-warning";
							case "OK":
								return "badge-success";
							default:
								return "badge-secondary";
						}
					},
				},
				filters: {
					truncate: function (text, length, suffix) {
						if (text.length > length) {
							return text.substring(0, length - suffix.length) + suffix;
						} else {
							return text;
						}
					}
				}
			});
		});
	</script>
	{% block bottom %}{% endblock %}
</body>
</html>